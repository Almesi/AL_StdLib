' Loops through Folders (Create Module per folder)
' Loops through Files and adds Code to Module
Private Sub AL_Include_Folder(VBProj As VBIDE.VBProject, FolderPath As String, ComponentType As Long, ComponentName As String)

    Dim fso As Object
    Dim Folder As Object
    Dim SubFolder As Object
    Dim File As Object
    Dim VBComp As VBIDE.VBComponent
    Dim VBCodeModule As VBIDE.CodeModule
    Dim FileArray() As Variant

    Set fso = CreateObject("Scripting.FileSystemObject")
    Set Folder = fso.GetFolder(FolderPath)
    Set FileArray = AL_GetBuildData(Folder)
    ' Get basic information from current folder and create new Component, if it doesnt already exist
    ComponentType = FileArray(0)
    If ComponentName <> Replace(FileArray(1), (FolderPath & "\"), "") Then
        ComponentName = Replace(FileArray(1), (FolderPath & "\"), "")
        For Each VBComp in VBProj.Component
            If VBComp.Name = ComponentName Then
                Exit For
            End If
        Next
        AL_BuildCreateVBComponent VBProj, FileArray(0), ComponentName
    End If
    Set VBComp = VBProj.VBComponents(FileArray(1))
    Set VBCodeModule = VBComp.CodeModule
    ' Add code in Stackform to Component
    For i = Ubound(FileArray) To 2 Step-1
        AL_BuildAddCode VBCodeModule, FileArray(1)
    Next i
    If ComponentType = vbext_ct_MSForm Then
        AL_Instant_Exe Folder, VBProj
    End If
    ' Loop through all Subfolders and Repeat
    For Each SubFolder In Folder.SubFolders
        AL_BuildFolder SubFolder.Path, ComponentType, ComponentName
    Next SubFolder

End Sub