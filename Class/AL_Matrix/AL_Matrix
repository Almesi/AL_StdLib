' Class module: AL_Matrix
' Describes a collection of Matrixfunctions for different Data types

' Variable Declaration
    Private p_Row As Integer
    Private p_Column As Integer
    Private p_Array()
    Private p_IsInitialized As Boolean
'

' Let Get Set
    Public Property Get Row() As Integer
        m_Row = p_Row
    End Property

    Public Property Get Column() As Integer
        m_Column = p_Column
    End Property

    Public Property Get Matrix() As AL_Matrix
        m_Matrix = p_Matrix
    End Property

    Public Property Get MatrixPoint(Row As Integer, Column As Integer) As Integer
        MatrixPoint = p_Array(Row, Column)
    End Property

    Public Property Let MatrixPoint(Row As Integer, Column As Integer, Value As Variant)
        p_Array(Row, Column) = Value
    End Property
'

Public Sub Initialize(Row As Integer, Column As Integer, DataType As String)

    If p_IsInitialized = False
        p_IsInitialized = True
        p_Row = Row
        p_Column = Column
        Select Case DataType
            Case "Integer"
                ReDim p_Array(Row, Column) As Integer
            Case "Single"
                ReDim p_Array(Row, Column) As Single
            Case "Double"
                ReDim p_Array(Row, Column) As Double
            Case "Long"
                ReDim p_Array(Row, Column) As Long
            Case "LongLong"
                ReDim p_Array(Row, Column) As LongLong
            Case Else
                AL_Error_Print 7, 1, "AL_Matrix"
                AL_Error_Show 7, 1, "AL_Matrix"
        End Select
    End If

End Sub

Public Function Multiply(Matrix1 As AL_Matrix, Matrix2 As AL_Matrix, DataType As String) As AL_Matrix

    Dim Matrix3 As New AL_Matrix
    Dim i As Integer, j As Integer, k As Integer
    Matrix3.Initialize(Matrix1.Row, Matrix2.Column, DataType)
    For i = 0 To Matrix3.Row
        For j = 0 To Matrix3.Column
            For k = 0 To Matrix2.Row
                Matrix3.MatrixPoint(i, j) = Matrix3.MatrixPoint(i, j) + (Matrix1.MatrixPoint(i, k) * Matrix2.MatrixPoint(k, j))
            Next
        Next
    Next
    Set Multiply = Matrix3

End Function

Public Sub Inverse()

    For i = 0 To p_Row
        For j = 0 To p_Column
            p_Array(i, j).MatrixPoint = 1 / p_Array(i, j).MatrixPoint
        Next
    Next
    
End Function

Public Function Divide(Matrix1 As AL_Matrix, Matrix2 As AL_Matrix, DataType As String) As AL_Matrix

    Dim Matrix3 As New AL_Matrix
    Dim i As Integer, j As Integer, k As Integer
    Matrix3.Initialize(Matrix1.Row, Matrix2.Column, DataType)
    Matrix2.Inverse
    For i = 0 To Matrix3.Row
        For j = 0 To Matrix3.Column
            For k = 0 To Matrix2.Row
                Matrix3.MatrixPoint(i, j) = Matrix3.MatrixPoint(i, j) + (Matrix1.MatrixPoint(i, k) * Matrix2.MatrixPoint(k, j))
            Next
        Next
    Next
    Set Multiply = Matrix3

End Function

Public Function Add(Matrix1 As AL_Matrix, Matrix2 As AL_Matrix, DataType As String) As AL_Matrix

    If Matrix1.Row = Matrix2.Row And Matrix1.Column = Matrix2.Column Then
        Dim Matrix3 As New AL_Matrix
        Dim i As Integer, j As Integer
        Matrix3.Initialize(Matrix1.Row, Matrix1.Column, DataType)
        For i = 0 To Matrix1.Row
            For j = 0 To Matrix1.Column
                Matrix3.MatrixPoint(i, j) = Matrix1.MatrixPoint(i, j) + Matrix2.MatrixPoint(i, j)
            Next
        Next
        Set Multiply = Matrix3
    End If

End Function

Public Function Subtract(Matrix1 As AL_Matrix, Matrix2 As AL_Matrix, DataType As String) As AL_Matrix

    If Matrix1.Row = Matrix2.Row And Matrix1.Column = Matrix2.Column Then
        Dim Matrix3 As New AL_Matrix
        Dim i As Integer, j As Integer
        Matrix3.Initialize(Matrix1.Row, Matrix1.Column, DataType)
        For i = 0 To Matrix1.Row
            For j = 0 To Matrix1.Column
                Matrix3.MatrixPoint(i, j) = Matrix1.MatrixPoint(i, j) - Matrix2.MatrixPoint(i, j)
            Next
        Next
        Set Multiply = Matrix3
    End If

End Function

Public Sub TEST()

    Dim Matrix As New AL_Matrix
    Dim Matrix2 As New AL_Matrix
    Dim Matrix3 As New AL_Matrix

    Matrix.Initialize 3, 4, "Single"
    For i = 0 To 3
        For j = 0 To 4
            Matrix.MatrixPoint(i, j) = (i * 10) + j
        Next
    Next
    Matrix2.Initialize 3, 4, "Single"
    For i = 0 To 3
        For j = 0 To 4
            Matrix2.MatrixPoint(i, j) = (i * 10) + j
        Next
    Next
    Matrix3 = Matrix3.Multiply(Matrix, Matrix2, "Single")
    Matrix2.Inverse
    Matrix3 = Matrix3.Divide(Matrix, Matrix2, "Single")
    Matrix3 = Matrix3.Add(Matrix, Matrix2, "Single")
    Matrix3 = Matrix3.Subtract(Matrix, Matrix2, "Single")

End Sub