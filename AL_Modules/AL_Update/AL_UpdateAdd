Sub AL_UpdateAdd(ByVal FilePath As String, ByVal InstanceType As Integer, ByVal InstanceName As String)
    Dim VBProj As VBIDE.VBProject
    Dim VBComp As VBIDE.VBComponent
    Set VBProj = ThisWorkbook.VBProject

    ' 0 means add code
    ' 1, 2, 3, 11, 100 means add Instance
    If AL_Check_String(InstanceName, 0) = False Then
        Exit Sub
    End If
    Select Case InstanceType
        Case 0
            If AL_Check_Instance(InstanceName, False) = False Then
                Exit Sub
            End If
            
            Dim FileLine As String
            Dim Index As Long
            Dim FileNumber As Integer
            Dim VBCodeModule As VBIDE.CodeModule

            Set VBComp = VBProj.VBComponents(InstanceName)
            Set VBCodeModule = VBComp.CodeModule
            Index = 1
            FileNumber = FreeFile
            Open FilePath For Input As #FileNumber
            Do Until EOF(FileNumber)
                Line Input #FileNumber, FileLine
                VBCodeModule.InsertLines Index, FileLine
                Index = Index + 1
            Loop
            Close #FileNumber
        Case 1, 2, 3, 11, 100
            If AL_Check_Instance(InstanceName, True) = False Then
                Exit Sub
            End If
            Set VBComp = vbProj.VBComponents.Add(InstanceType)
            VBComp.Name = InstanceName 
        Case Else
            AL_Error_Print 1, 2, InstanceType, InstanceName
            AL_Error_Show 1, 2, InstanceType, InstanceName
            Exit Sub
    End Select
    
End Sub